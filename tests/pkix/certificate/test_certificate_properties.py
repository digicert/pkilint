from pkilint import loader, pkix

_BAD_VALIDITY_TIMES_CERT_PEM = """-----BEGIN CERTIFICATE-----
MIIFwjCCA6qgAwIBAgIUH/nOhctN2lspZ2LasyeIMEixJzEwDQYJKoZIhvcNAQEL
BQAwSDELMAkGA1UEBhMCVVMxHzAdBgNVBAoMFkZvbyBJbmR1c3RyaWVzIExpbWl0
ZWQxGDAWBgNVBAMMD0ludGVybWVkaWF0ZSBDQTAeFw1BMzA0MTkwMDAwMDBaFw1B
MzA3MTgyMzU5NTlaME4xIjAgBgNVBAMMGWhhbmFrby55YW1hZGFAZXhhbXBsZS5j
b20xKDAmBgkqhkiG9w0BCQEWGWhhbmFrby55YW1hZGFAZXhhbXBsZS5jb20wggEi
MA0GCSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQCw+egZQ6eumJKq3hfKfED4dE/t
L4FI5sjqont9ABVI+1GSqyi1bFBgsRjM0THllIdMbKmJtWwnKW8J+5OgNN8y6Xxv
8JmM/Y5vQt2lis0fqXmG8UTz0VTWdlAXXmhUs6lSADvAaIe4RVrCsZ97L3ZQTryY
7JRVcbB4khUN3Gp0yg+801SXzoFTTa+UGIRLE66jH51aa5VXu99hnv1OiH8tQrjd
i8mH6uG/icq4XuIeNWMF32wHqIOOPvQcWV3M5D2vxJEj702Ku6k9OQXkAo17qRSE
onWW4HtLbtmS8He1JNPc/n3dVUm+fM6NoDXPoLP7j55G9zKyqGtGAWXAj1MTAgMB
AAGjggGcMIIBmDAMBgNVHRMBAf8EAjAAMA4GA1UdDwEB/wQEAwIHgDAfBgNVHSME
GDAWgBTWRAAyfKgN/6xPa2buta6bLMU4VDAdBgNVHQ4EFgQUiRlZXg7xafXLvUfh
NPzimMxpMJEwFAYDVR0gBA0wCzAJBgdngQwBBQECMD0GA1UdHwQ2MDQwMqAwoC6G
LGh0dHA6Ly9jcmwuY2EuZXhhbXBsZS5jb20vaXNzdWluZ19jYV9jcmwuY3JsMEsG
CCsGAQUFBwEBBD8wPTA7BggrBgEFBQcwAoYvaHR0cDovL3JlcG9zaXRvcnkuY2Eu
ZXhhbXBsZS5jb20vaXNzdWluZ19jYS5kZXIwHQYDVR0lBBYwFAYIKwYBBQUHAwQG
CCsGAQUFBwMCMHcGA1UdEQRwMG6BGWhhbmFrby55YW1hZGFAZXhhbXBsZS5jb22g
KQYKKwYBBAGCNxQCA6AbDBloYW5ha28ueWFtYWRhQGV4YW1wbGUuY29toCYGCCsG
AQUFBwgJoBoMGOWxseeUsOiKseWtkEBleGFtcGxlLmNvbTANBgkqhkiG9w0BAQsF
AAOCAgEAg4rIcKGMfLh347FX/Y12lx7b9/iVrjsX7lsliirpITuPmfCli76JVrO0
Fqypfdd2P4ZVvH9WTpQUhRBv06kwHkJRkgpqNPO0WOpNVnsK8vcP1/RylDiJGryz
u6AzOSDqsxomFD6hm71XRYcsgBXXNPUzSGhbqUeuBuZwZe1WmP/yuvNpghMvlWFc
jAHktC9FuNpHhQ/3zZ20GUc6AQwwtn8rviFSwQihVJDJkGiGaJUc7lVVoswx87bS
oGpVluEIY/RK2HsXU0kmek4qq2t9v1OgRL98ZqUgOS26ooOXxqnR3QMx1S5KSLy9
+hK6y2gPhyiHoaPVTk4s54Es/YDtbCz7piyyyp3DEIzmgrwB/mG2IbOv6dT8Za5B
R7A+ggB7uwo3zYxKd2SFIDmXb+n9ML/s6/3aeyKJms4FmRq+fX8icb+lvVeLMhlC
Re5MFL2tkb72BFku0eeUde4iUnw93fzG6+Wl8VPCzYOwV0j+UTiyygcXaEZW+TpT
EmyY/fQ/7TCbGp+8Ur3rLlY5Okt5T83MmZdMFIHLQxaZUXkT2dBaSnh3VfNKFi0a
re9xdiBQZGkMkvWiKTjrUOwLXSNBnP6TXO9zn51tTK4KPZnQvNvULtn4H7z3FhfW
kie/jPNYkFvMzOaawwPAhG9R6G2ZB7cTOuG0Uu863Hkh5XX2oAo=
-----END CERTIFICATE-----"""


_BAD_BC_ENCODING_CERT_PEM = """-----BEGIN CERTIFICATE-----
MIIGCDCCBPCgAwIBAgIQR97MnKh70qpmTcj8p3ONNzANBgkqhkiG9w0BAQsFADBA
MQswCQYDVQQGEwJDTjERMA8GA1UECgwIVW5pVHJ1c3QxHjAcBgNVBAMMFVNIRUNB
IEVWIFNlcnZlciBDQSBHMzAeFw0yNDAzMTgwNTM0MTBaFw0yNTAzMTgxNTU5NTla
MIIBbTEdMBsGA1UEDxMUUHJpdmF0ZSBPcmdhbml6YXRpb24xEzARBgsrBgEEAYI3
PAIBAxMCQ04xGjAYBgsrBgEEAYI3PAIBAgwJ5LiK5rW35biCMRowGAYLKwYBBAGC
NzwCAQEMCeS4iua1t+W4gjEbMBkGA1UEBRMSOTEzMTAwMDA2MzEyOTEyODlYMQsw
CQYDVQQGEwJDTjESMBAGA1UECAwJ5LiK5rW35biCMRIwEAYDVQQHDAnkuIrmtbfl
uIIxDzANBgNVBBETBjIwMDA4MDFDMEEGA1UECQw65LiK5rW35biC6Jm55Y+j5Yy6
5Zub5bed5YyX6LevMTcxN+WPtzE4MDjjgIExODA544CBMTgxMOWupDE2MDQGA1UE
Cgwt5LiK5rW35biC5pWw5a2X6K+B5Lmm6K6k6K+B5Lit5b+D5pyJ6ZmQ5YWs5Y+4
MR8wHQYDVQQDExZyc2FldmczLmdvb2Quc2hlY2EuY29tMIIBIjANBgkqhkiG9w0B
AQEFAAOCAQ8AMIIBCgKCAQEAwlNS/toKnTO8fBgSSUTQ9RxiEiFX406s8nPvTziF
SoQ/S/ncHyFe8SeTRUO1tT/tmEzg6YZS5kaxiRFNOCaddZKPBb4nJMH/jliIjFZh
fXq5voZhMafXFJmtjWR3oSGZjienA5Eanra/q9srpACSmhpgL156CPjMqGJfJiOh
Ejxh7fkipX056j6Yrrs0btdrs4ZHcZeqJBz4ioiXNi2f5xqVdJvan53Q9LYp2TBG
v61y6zKj0WXeFh2zJIo32NCosRjAtO32BVJW6eTrmwNR3CmFzT0yILGCpsgIGMEn
hQjfZL/8RyeVYfMYT2mMcLLVlg1BeP30S5Lf1BU3Xg/mEQIDAQABo4IBzTCCAckw
HwYDVR0jBBgwFoAUVOly+3hmn+XL8zuPmEZVU3OcC4QwHQYDVR0OBBYEFFByjRc+
8e43B7pqhb9senT1Wn4uMA4GA1UdDwEB/wQEAwIFoDAdBgNVHSUEFjAUBggrBgEF
BQcDAQYIKwYBBQUHAwIwXwYDVR0gBFgwVjA7BgkqgRyG7zoBAQMwLjAsBggrBgEF
BQcCARYgaHR0cHM6Ly93d3cuc2hlY2EuY29tL3JlcG9zaXRvcnkwFwYFZ4EMAQEw
DjAMBggrBgEFBQcCARYAMCEGA1UdEQQaMBiCFnJzYWV2ZzMuZ29vZC5zaGVjYS5j
b20wDAYDVR0TAQH/BAIwADA4BgNVHR8EMTAvMC2gK6AphidodHRwOi8vY3JsLmds
b2JhbC5zaGVjYS5jb20vZXZzY2FnMy5jcmwwdwYIKwYBBQUHAQEEazBpMDAGCCsG
AQUFBzABhiRodHRwOi8vb2NzcC5nbG9iYWwuc2hlY2EuY29tL2V2c2NhZzMwNQYI
KwYBBQUHMAKGKWh0dHA6Ly9jZXJ0cy5nbG9iYWwuc2hlY2EuY29tL2V2c2NhZzMu
Y2VyMBMGCisGAQQB1nkCBAMBAf8EAgUAMA0GCSqGSIb3DQEBCwUAA4IBAQCk8rXL
a2TIXwOzeGB7oHcq0h67FrGYs58dIxaGYzf/VSOosZ3knCj8iS3gH0knVHg8F+47
k1kgEWYF70PykQDdDYl0HnI+qapklCgCBC6PbJpU6d9LQ/hSJhfe6arZg5THJCYF
sG/1jEj1SEgJCcUGGX1Rt251m4GnGKxTHKEciGEq0EYKWd8uYkLtktZBpUB1HvJM
AFXfgZmfibVTExqrX+s1TGGUaoz9ktHxoQuc1slclELGmRVv0L4YIrbs3UCCGUSp
PNpRbwFwgDtFcAAI5Oc7q3ruxTrPgJb75uC6LiYNXkHSyB6JIUW8rITPv99tAk3G
1CWF8wYw6JLxGNr7
-----END CERTIFICATE-----"""


def test_bad_time():
    cert = loader.load_pem_certificate(_BAD_VALIDITY_TIMES_CERT_PEM)

    assert cert.not_before == pkix.MAXIMUM_TIME_DATETIME
    assert cert.not_after == pkix.MAXIMUM_TIME_DATETIME


def test_bad_bc_encoding():
    cert = loader.load_pem_certificate(_BAD_BC_ENCODING_CERT_PEM)

    assert not cert.is_ca
