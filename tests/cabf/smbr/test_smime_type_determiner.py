from pkilint.cabf import smime
from pkilint import loader
from pkilint.cabf.smime import smime_constants

_TLS_PEM = """-----BEGIN CERTIFICATE-----
MIIH4TCCBcmgAwIBAgIKFFugogAAAAAaXDANBgkqhkiG9w0BAQ0FADCBhjELMAkG
A1UEBhMCVVMxCzAJBgNVBAgTAk1OMRQwEgYDVQQHEwtNaW5uZWFwb2xpczExMC8G
A1UEChMoT3BlbiBBY2Nlc3MgVGVjaG5vbG9neSBJbnRlcm5hdGlvbmFsIEluYzEh
MB8GA1UEAxMYd2ViQ0FSRVMgSXNzdWluZyBDQSAyMDIxMB4XDTIyMTAzMTE4NDEw
OFoXDTIzMTIwMjE4NTEwOFowgaExIDAeBgkqhkiG9w0BCQEWEU5XTVRUZWFtQG9h
dGkubmV0MQswCQYDVQQGEwJVUzELMAkGA1UECBMCTU4xFDASBgNVBAcTC01pbm5l
YXBvbGlzMTEwLwYDVQQKEyhPcGVuIEFjY2VzcyBUZWNobm9sb2d5IEludGVybmF0
aW9uYWwgSW5jMRowGAYDVQQDExFtdnMubndtdC5vYXRpLmNvbTCCASIwDQYJKoZI
hvcNAQEBBQADggEPADCCAQoCggEBAM3JmlCtXR4MvTxKyk32a8umNq2utw+6ypq+
fAU0eY+RtsRXY6+zf/G4BZaIULj2A91Sul+E+1x0Af/mlYQNZNDaRoQrSIZt1SGP
4isAeEhBdYXef8QiyyzPuYHr2CaNzss+pryPAyyJI0Vk5/RXJaZ2t7KUknkSJGCI
1kPUGRtTsSdySKqUDx42zRMHI/3eWHqmCDlC515E1ZR/9EYvAin5CBgTHklAKyt6
DYsHkaXKeA6jCZwZGVE2S6pHvZ61PVNmVKpIz7OcUUCgHChyDOYguvhri6f38cWp
YwwZ8NC+sJZx3hLp2OxwGll1Lbzj6wl933TMfO42L2b+rcozcaUCAwEAAaOCAzIw
ggMuMHgGCSqGSIb3DQEJDwRrMGkwDgYIKoZIhvcNAwICAgCAMA4GCCqGSIb3DQME
AgIAgDALBglghkgBZQMEASowCwYJYIZIAWUDBAEtMAsGCWCGSAFlAwQBAjALBglg
hkgBZQMEAQUwBwYFKw4DAgcwCgYIKoZIhvcNAwcwEwYKKwYBBAHWeQIEAwEB/wQC
BQAwgbsGCCsGAQUFBwEBBIGuMIGrMEAGCCsGAQUFBzAChjRodHRwOi8vY2VydHMu
b2F0aWNlcnRzLmNvbS9yZXBvc2l0b3J5L09BVElJQTIwMjEuY3J0MDsGCCsGAQUF
BzAChi9odHRwOi8vY2VydHMub2F0aS5uZXQvcmVwb3NpdG9yeS9PQVRJSUEyMDIx
LmNydDAqBggrBgEFBQcwAYYeaHR0cDovL29jc3Aub2F0aWNlcnRzLmNvbS9vY3Nw
MB0GA1UdDgQWBBRDR89TrNLJzAqQKZF6kj6VWhgnxDAcBgNVHREEFTATghFtdnMu
bndtdC5vYXRpLmNvbTB2BgNVHR8EbzBtMGugaaBnhjRodHRwOi8vY2VydHMub2F0
aWNlcnRzLmNvbS9yZXBvc2l0b3J5L09BVElJQTIwMjEuY3Jshi9odHRwOi8vY2Vy
dHMub2F0aS5uZXQvcmVwb3NpdG9yeS9PQVRJSUEyMDIxLmNybDBZBgNVHSAEUjBQ
MEQGC2CGSAGG/kkBDAICMDUwMwYIKwYBBQUHAgEWJ2h0dHA6Ly93d3cubmFlc2Iu
b3JnL1BLSS9Bc3N1cmFuY2VMZXZlbDAIBgZngQwBAgIwgbkGA1UdIwSBsTCBroAU
CwOr1KI4NqbtuAPS9IieDProTmmhgYmkgYYwgYMxCzAJBgNVBAYTAlVTMQswCQYD
VQQIEwJNTjEUMBIGA1UEBxMLTWlubmVhcG9saXMxMTAvBgNVBAoTKE9wZW4gQWNj
ZXNzIFRlY2hub2xvZ3kgSW50ZXJuYXRpb25hbCBJbmMxHjAcBgNVBAMTFU9BVEkg
V2ViQ0FSRVMgUm9vdCBDQYIKTdXItAAAAAAAIzATBgNVHSUEDDAKBggrBgEFBQcD
ATANBgkqhkiG9w0BAQ0FAAOCAgEAaq5L7qQTotXJlA+h4QSO5VY9fUP8gZcxzOJD
CEAauz65in8MgLKG3Z/sN7L6LUG5fJvHUFcUQAIKnaBzjf29pJ/gxEjLtj2SaH9M
UKNOamDLPBOtuBp6aeT3DQlu6Su3/IXRUFesE6SOezGrjQqBdZdb4SiAflSAIg9p
o88sHcl8EXf+317cXJi3OWosCd75UxWX2HumjxsU8WsfdrQ2PcOzVNahNBODR6nz
Q/KIzSaT2x+l5kl0YH8Mgu7m4fnceTP0Tav4xRMdIHakKwg961fI9Rw64+yJOo/Q
szcZM+tKOAAQZUqXzTG3qeoiKIoI/aF0LCQbraZhkEbUSkaAG+BaWYrKu40StUu4
iqwmJUdrOdLJCeDzpI1B2rJ8vUu2zNXB9BTvo56XUPITcKfQJz/pNN7o6L0YXNCU
c1jZeqqVAlUUvxAgK9lWLTIz3X9NoycGMNTuDbhLc3R7g/XJyIpTEC8EYULUCZ2i
q/nUoY6kQ4OShPW7Q3iLNnlV4zCu1dfhYAb7yIgG8IGwpoXjXkfKt1VvhSZD7R1D
RSNS1KTypShsoTkCurQ2/P9M4VS6SsuY61INsp35ZDtCeNhoy7EGM8qRLVi31YTJ
uZVrfPbKYU/OkiGqzpmqj7WCBPgao0DQg2xRuUl2lhT7ar2QcvYh0TnumyU4hGKh
MxHrgeQ=
-----END CERTIFICATE-----"""


_ORGANIZATION_MULTIPURPOSE_PEM = """
-----BEGIN CERTIFICATE-----
MIIGQzCCBCugAwIBAgIUT0nGRo909AMp7EmYVoILmgwKMsQwDQYJKoZIhvcNAQEL
BQAwSDELMAkGA1UEBhMCVVMxHzAdBgNVBAoMFkZvbyBJbmR1c3RyaWVzIExpbWl0
ZWQxGDAWBgNVBAMMD0ludGVybWVkaWF0ZSBDQTAeFw0yMzA0MjgwMDAwMDBaFw0y
MzA3MjcyMzU5NTlaMFgxDDAKBgNVBGETA0dPVjEeMBwGA1UEChMVQWNtZSBJbmR1
c3RyaWVzLCBMdGQuMSgwJgYJKoZIhvcNAQkBFhloYW5ha28ueWFtYWRhQGV4YW1w
bGUuY29tMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAsPnoGUOnrpiS
qt4XynxA+HRP7S+BSObI6qJ7fQAVSPtRkqsotWxQYLEYzNEx5ZSHTGypibVsJylv
CfuToDTfMul8b/CZjP2Ob0LdpYrNH6l5hvFE89FU1nZQF15oVLOpUgA7wGiHuEVa
wrGfey92UE68mOyUVXGweJIVDdxqdMoPvNNUl86BU02vlBiESxOuox+dWmuVV7vf
YZ79Toh/LUK43YvJh+rhv4nKuF7iHjVjBd9sB6iDjj70HFldzOQ9r8SRI+9Nirup
PTkF5AKNe6kUhKJ1luB7S27ZkvB3tSTT3P593VVJvnzOjaA1z6Cz+4+eRvcysqhr
RgFlwI9TEwIDAQABo4ICEzCCAg8wDAYDVR0TAQH/BAIwADAOBgNVHQ8BAf8EBAMC
B4AwHwYDVR0jBBgwFoAU1kQAMnyoDf+sT2tm7rWumyzFOFQwHQYDVR0OBBYEFIkZ
WV4O8Wn1y71H4TT84pjMaTCRMBQGA1UdIAQNMAswCQYHZ4EMAQUCAjA9BgNVHR8E
NjA0MDKgMKAuhixodHRwOi8vY3JsLmNhLmV4YW1wbGUuY29tL2lzc3VpbmdfY2Ff
Y3JsLmNybDBLBggrBgEFBQcBAQQ/MD0wOwYIKwYBBQUHMAKGL2h0dHA6Ly9yZXBv
c2l0b3J5LmNhLmV4YW1wbGUuY29tL2lzc3VpbmdfY2EuZGVyMB0GA1UdJQQWMBQG
CCsGAQUFBwMEBggrBgEFBQcDAjCByAYDVR0RBIHAMIG9gRloYW5ha28ueWFtYWRh
QGV4YW1wbGUuY29toCkGCisGAQQBgjcUAgOgGwwZaGFuYWtvLnlhbWFkYUBleGFt
cGxlLmNvbaAmBggrBgEFBQcICaAaDBjlsbHnlLDoirHlrZBAZXhhbXBsZS5jb22k
TTBLMSMwIQYDVQRhExpMRUlYRy1BRVlFMDBFS1hFU1ZaVVVFQlA2NzEkMCIGA1UE
Cgwb44Ki44Kv44Of5bel5qWt5qCq5byP5Lya56S+MCMGCSsGAQQBg5gqAQQWExRB
RVlFMDBFS1hFU1ZaVVVFQlA2NzANBgkqhkiG9w0BAQsFAAOCAgEAALJ+FR219frG
JUfrL8xWFfRuFCnLdyzM78Ey0qJqZES199XlYozXhMzCUKYN/zbmery90uWNyuJt
YGJYl0lhfzBxMmMHk88gCDkLyj8h4a+r2NiQsiN2bXXp1t5CStQeoaljZL9r2IIE
RGB+MigR1Rz7g1ECvVo7+llr3/EwqV9aa88OtnmQoroSlk86hTGjdEUuixhR2T+/
VMEpdlxmimg88E8afa05yc+GBGnxhyk2zk+nbusC1TrEnMsF2zIaMGlHjMP/v3Gs
l1VucFutU06xhItWmWYcHeVr0wLO/gMDdSbIUgsxobvWynh52D4D1gJsHpnelc5E
yGCxhLp7X9tjIy7pSXQAA9fy63cdSk6xbpYtlCU/S0PGm+gMMKAydAunL2WgqEwp
FB0TwuE+obw3jJI2eO15YFJU5qEt5eNM2H7KzO0R5lZE0wnbmhgggYGrc6SFsVzg
CocwHOtG9hETci6imtbQ8XoiY86KLUaxYcR4ilXoFj3yhKy8qP7LHdg+sI3/2sIV
koohmnIEidKmO4lhGqavh8bSVLy00PiebItEVoD4hgMtrcl3c8yM7C/cpXtmlRvk
49RnJJiSPnSS+34I2DKmhS7ZCqHRPyUdE6ebULW+ZCNc3vG4yleapzJQiFdUbWgL
m8XfBNHSAWs3NvdzV/MqQUERWI3VEdQ=
-----END CERTIFICATE-----
"""


def test_tls_cert():
    cert = loader.load_pem_certificate(_TLS_PEM)

    assert smime.determine_validation_level_and_generation(cert) is None


def test_org_mp():
    cert = loader.load_pem_certificate(_ORGANIZATION_MULTIPURPOSE_PEM)

    assert smime.determine_validation_level_and_generation(cert) == (
        smime_constants.ValidationLevel.ORGANIZATION,
        smime_constants.Generation.MULTIPURPOSE,
    )
